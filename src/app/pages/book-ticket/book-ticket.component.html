<div class="container my-4">

    <!-- ================= BUS DETAILS CARD ================= -->
    <div class="card p-4 shadow-sm mb-4 border-0 rounded-4">
      <div class="row">
        <div class="col-md-8">
          <h4 class="fw-bold">{{busDetails.busName}}</h4>
          <p class="text-muted mb-1">
            {{busDetails.scheduleDate}} • <strong>{{busDetails.departureTime | date: 'hh:mm:ss'}} - {{busDetails.arrivalTime | date: 'hh:mm:ss'}}</strong>
          </p>
        </div>
  
        <div class="col-md-4 text-end">
          <h6 class="mb-1">{{fromLocation}} → {{toLocation}}</h6>
          <p class="text-muted">Duration: <strong>8h 30m</strong></p>
        </div>
      </div>
    </div>
  
    <div class="row">
  
      <!-- ===================== LEFT : SEAT SELECTION ===================== -->
      <div class="col-md-8">
  
        <div class="card p-4 shadow-sm border-0 rounded-4 mb-4">
  
          <!-- Header -->
          <div class="d-flex justify-content-between">
            <h5 class="fw-bold">Select Seats</h5>
  
            <div class="d-flex gap-3 text-muted small">
              <span><i class="fa-regular fa-square text-primary me-1"></i>Available</span>
              <span><i class="fa-solid fa-square text-secondary me-1"></i>Booked</span>
              <span><i class="fa-solid fa-square text-success me-1"></i>Selected</span>
            </div>
          </div>
  
          <hr>
  
          <!-- FRONT LABEL -->
          <div class="text-center text-muted mb-2 fw-semibold">Front</div>
  
          <!-- SEAT GRID -->
          <div class="container text-center">
            <div class="row">
              @for (seat of seatArray; track seat) {
                <div class="col-2 mb-3 d-flex justify-content-center">
                  <button
                    class="btn seat"
                    (click)="onSelect(seat)"
                    [ngClass]="{
                      'selected': isSeatSelected(seat),
                      'booked': checkIfBooked(seat),
                      'available': !isSeatSelected(seat) && !checkIfBooked(seat)
                  }"

                    [disabled]="checkIfBooked(seat)"
                  >
                    {{ seat }}
                  </button>
                </div>
              }
            </div>
            
          </div>
          

          
  
        </div>
      </div>
  
      <!-- ===================== RIGHT : BOOKING SUMMARY ===================== -->
      <div class="col-md-4">
  
        <div class="card shadow-sm p-4 border-0 rounded-4">
  
          <h5 class="fw-bold mb-3">Booking Summary</h5>
  
          <!-- Selected Seats -->
          
          <div class="mb-3">
            @if(selectedSeatArray.length==0){
              <p class="fw-semibold mb-1">No Seats are selected</p>
            }
            @else{
              <p class="fw-semibold mb-1">Selected Seats</p>
              @for(passenger of selectedSeatArray; track $index){
                <span class="badge bg-primary rounded-pill me-1">Seat {{passenger.seatNo}}</span>
              }
            }
          </div>
  
          <hr>
  
          <!-- Fare Details -->
          <p class="fw-semibold mb-1">Fare Details</p>
  
          <div class="d-flex justify-content-between">
            <span class="text-muted">Base Fare ({{selectedSeatArray.length}} seats)</span>
            <strong>{{ selectedSeatArray.length*busDetails.price | currency: 'INR'}}</strong>
          </div>
  
          <div class="d-flex justify-content-between">
            <span class="text-muted">Tax (5%)</span>
            <strong>{{ selectedSeatArray.length*busDetails.price*0.05 | currency: 'INR'}}</strong>
          </div>
  
          <div class="d-flex justify-content-between mt-2">
            <span class="fw-semibold">Total Amount</span>
            <strong class="fs-5">{{ selectedSeatArray.length*busDetails.price*1.05 | currency: 'INR'}}</strong>
          </div>
  
          <hr>
  
          <!-- Contact Details -->
          <p class="fw-semibold">Contact Details</p>
          @for(passenger of selectedSeatArray; track $index){
          <div class="row">
            <div class="mb-3">
              <label class="form-label">Passenger {{$index + 1}} name</label>
              <input [(ngModel)] = "passenger.passengerName" type="text" class="form-control" placeholder="Enter name">
            </div>
    
            <div class="mb-3">
              <label class="form-label">Gender of Passenger {{$index + 1}}</label>
              

                <div class="form-check">
                  <input 
                    class="form-check-input" 
                    type="radio" 
                    [name]="'gender' + $index"
                    id="male" 
                    value="male"
                    [(ngModel)] = "passenger.gender"
                  />
                  <label class="form-check-label" for="male">
                    Male
                  </label>
                </div>

                <div class="form-check">
                  <input 
                    class="form-check-input" 
                    type="radio" 
                    [name]="'gender' + $index"
                    id="female" 
                    value="female"
                    [(ngModel)] = "passenger.gender"
                  />
                  <label class="form-check-label" for="female">
                    Female
                  </label>
                </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Age of Passenger {{$index + 1}}</label>
              <input [(ngModel)] = "passenger.age" type="number" class="form-control" placeholder="Enter phone number">
            </div>

            <hr>
          </div>
        }
          <button class="btn btn-primary w-100 py-2 mt-2" (click)="completeBooking()" type = "button">
            Book tickets
          </button>
  
        </div>
  
      </div>
    </div>
  </div>
  
  <!-- ===================== EXTRA CSS FOR SEAT DESIGN ===================== -->
  <style>
    
    .available {
  background: #f8f9fa;
  border: 1px solid #0d6efd; /* thin blue border */
  outline: 1px solid #0d6efd33; /* faint blue outline */
  outline-offset: 1px;
  border-radius: 4px;
}

    .selected { background:rgb(92, 222, 92);}
    .booked{
      background: grey;
    }
    .seat-grid { width: 100%; }

    .seat {
  width: 50px;
  height: 50px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 18px;
  padding: 0;
}




  </style>
  